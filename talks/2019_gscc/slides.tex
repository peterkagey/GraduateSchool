\documentclass{beamer}%
% Choose how your presentation looks.
%
% For more themes, color themes and font themes, see:
% http://deic.uab.es/~iblanes/beamer_gallery/index_by_theme.html
%
\mode<presentation>
{
  \usetheme{default}      % or try Darmstadt, Madrid, Warsaw, ...
  \usecolortheme{beaver} % or try albatross, beaver, crane, ...
  \usefonttheme{default}  % or try serif, structurebold, ...
  \usefonttheme[onlymath]{serif}
  \setbeamertemplate{navigation symbols}{}
  \setbeamertemplate{caption}[numbered]
}

\setlength{\belowcaptionskip}{-10pt}

\usepackage[english]{babel}
\usepackage[utf8x]{inputenc}
\usepackage{mathtools}
\usepackage{tikz}

\newcommand\indx[2]{\genfrac{}{}{0pt}{1}{#1}{#2}}
\newcommand\indxx[2]{#1#2}
\newcommand\indxxx[2]{\genfrac{}{}{0pt}{0}{#1}{#2}}

\newcommand\paren[1]{\biggl(#1\biggr)}
\newcommand\set[1]{\left\{#1\right\}}

\title{Counting structures on the $n \times k$ grid graph}
\author{Peter Kagey}
\institute{University of Southern California}
\date[]{
  Graduate Student Combinatorics Conference\\
  April 2019
}

\begin{document}
\begin{frame}
  \titlepage
\end{frame}

% Uncomment these lines for an automatically generated outline.
%\begin{frame}{Outline}
%  \tableofcontents
%\end{frame}

\begin{frame}{Commodore 64 (1/3)} % https://www.youtube.com/watch?v=m9joBLOZVEo
  % When I was working in software, I became known for my one-off programming
  % projects, and so when my colleague ran across this video, he sent it to me,
  % and it indeed piqued my curiosity.
  \center{\includegraphics[width=300pt]{commodore64_1.png}}
\end{frame}

\begin{frame}{Commodore 64 (2/3)} % https://www.youtube.com/watch?v=m9joBLOZVEo
  \center{\includegraphics[width=300pt]{commodore64_2.png}}
\end{frame}

\begin{frame}{Commodore 64 (3/3)} % https://www.youtube.com/watch?v=m9joBLOZVEo
  \center{\includegraphics[width=300pt]{commodore64_3.png}}
\end{frame}

\begin{frame}{Javascript} % https://www.youtube.com/watch?v=m9joBLOZVEo
  \center{\includegraphics[width=300pt]{website_pre.png}}
\end{frame}

\begin{frame}{Javascript} % https://www.youtube.com/watch?v=m9joBLOZVEo
  \center{\includegraphics[width=300pt]{website_post.png}}
\end{frame}

\begin{frame}{Counting grids} % V2 Problem 56.
  \begin{figure}
    \input{diagrams/diagonal-quarter_circle_duality}
    \caption{An illustration of the bijection between tiles with diagonal markings and tiles with quarter circles in opposite corners.}
  \end{figure}
\end{frame}

\begin{frame}{A295229: Number of tilings of the $n \times n$ grid, using diagonal lines to connect the grid points.}
  % A295229
  \input{diagrams/2X2_diagonals_up_to_symmetry}
  \[
    a(n) = \begin{cases}
      \frac 18 (2^{n^2} + 2\cdot2^{n(n+1)/2} + 3\cdot2^{n^2/2} + 2\cdot2^{n^2/4}) & n \text{ even} \\
      \frac 18 (2^{n^2} + 2\cdot2^{n(n+1)/2} + 2^{(n^2+1)/2}) & n \text{ odd}
    \end{cases}
  \]
  % $1, 6, 84, 8548, 4203520, 8590557312, 70368815480832, \hdots$
\end{frame}

\begin{frame}{Other tiles} % https://www.youtube.com/watch?v=m9joBLOZVEo
    \begin{figure}
      \input{diagrams/box_drawing_characters}
      \includegraphics[width=230pt]{pseudomaze2.png}
      \caption{Eleven box-drawing characters placed on an $15 \times 8$ grid}
    \end{figure}
\end{frame}

\begin{frame}{Baby's first corollary}
  \begin{corollary}[of Burnside's Lemma]
    Let \begin{itemize}
      \item $t$ be the number of tiles,
      \item $q$ be the number of tiles symmetric under a $90^\circ$ rotation,
      \item $h$ be the number of tiles symmetric under a $180^\circ$ rotation,
      \item $d$ be the number of tiles symmetric under a diagonal reflection, and
      \item $v$ be the number of tiles symmetric under a vertical reflection.
    \end{itemize}
    Then the number of tilings up to symmetries of the square is
  \[
    a(n) = \begin{cases}
      \frac 18 \paren{
        t^{n^2} + 2qt^{\frac{n^2-1}{4}} + ht^{\frac{n^2-1}{2}} + (v^n + d^n)t^{\frac{n^2-n}{2}}
      } & n \text{ odd} \\
      \\
      \frac 18 \paren{
        t^{n^2} + 3t^{\frac{n^2}{2}} + 2t^{\frac{n^2}{4}} + 2d^n t^{\frac{n^2-n}{2}}
      } & n \text{ even}
    \end{cases}
  \]
  \end{corollary}
\end{frame}

\begin{frame}{Pipe Mania}
  \center{\includegraphics[width=300pt]{pipe_mania.png}}
\end{frame}

\begin{frame}{Leaf Free Grids} % V2 Problem 56.
  % Can also use this to count multipartite graphs and planar multipartite graphs.
  \input{diagrams/leaf_free_4X12}
  The $n \times 2$ grid, obeys the recurrence
  \begin{align*}
    a_2(1) &= 1,\ a_2(2) = 2 \\
    a_2(n) &= 5a(n-1) - 5a(n-2).
    % \\
    % \\
    % a_3(1) &= 1, a_3(2) = 5, a_3(3) = 43, a_3(4) = 463 \\
    % a_3(n) &= 12a(n-1) - 6a(n-2) - 20a(n-3) - 5a(n-4)
    % \\
    % \\
    % a_4(1) &= 1, a_4(2) = 15, a_4(3) = 463, a_4(4) = 16372, \\
    % a_4(5) &= 583199, a_4(6) = 20788249  \\
    % a_4(n) &= 36a_4(n-1) - 7a_4(n-2) - 201a_4(n-3) + 49a_4(n-4) \\
    % &+ 20a_4(n-5) - 5a_4(n-6)
  \end{align*}
\end{frame}

\begin{frame}{Leaf Free subgraphs: The System of Recurrences}
  \begin{figure}
    \input{diagrams/state_2X13}
    \caption{An example of a leaf-free subgraph with its states labeled}
  \end{figure}
  \begin{figure}
    \input{diagrams/next_generation_2Xn}
    \caption{Two examples of transitions from states to their children}
  \end{figure}
\end{frame}
%
\begin{frame}{Example: A System of Recurrences}
  The $1 \times 2$ grid has initial conditions
  \begin{align*}
    a_{\indxx 00}(1) &= a_{\indxx 11}(1) = 1 \\
    a_{\indxx 10}(1) &= a_{\indxx 01}(1) = a_{\indxx 12}(1) = a_{\indxx 21}(1) = a_{\indxx 22}(1) = 0,
  \end{align*}
  and satisfies the system of first order homogeneous difference relations
  \begin{align*}
    a_{\indxx 00}(n + 1) &= a_{\indxx 00}(n) + a_{\indxx 22}(n) \\
    a_{\indxx 01}(n + 1) &= a_{\indxx 01}(n) + a_{\indxx 21}(n) + a_{\indxx 22}(n) \\
    a_{\indxx 10}(n + 1) &= a_{\indxx 10}(n) + a_{\indxx 12}(n) + a_{\indxx 22}(n) \\
    a_{\indxx 11}(n + 1) &= a_{\indxx 00}(n) + a_{\indxx 11}(n) + a_{\indxx 12}(n)
                      + a_{\indxx 21}(n) + 2a_{\indxx 22}(n) \\
    a_{\indxx 12}(n + 1) &= a_{\indxx 01}(n) + a_{\indxx 21}(n) + a_{\indxx 22}(n) \\
    a_{\indxx 21}(n + 1) &= a_{\indxx 10}(n) + a_{\indxx 12}(n) + a_{\indxx 22}(n) \\
    a_{\indxx 22}(n + 1) &= a_{\indxx 11}(n) + a_{\indxx 12}(n) + a_{\indxx 21}(n) + a_{\indxx 22}(n).
  \end{align*}
\end{frame}

\begin{frame}{A single recurrence from a system of recurrences}
  \begin{theorem}[Corollary of Cayleyâ€“Hamilton theorem]
    In a system of first order homogeneous linear difference equations, \begin{align*}
      a^{(1)}(n+1) &= \alpha_{11}a^{(1)}(n) + \hdots + \alpha_{1k}a^{(k)}(n) \\
      \vdots\hspace{25pt} &= \hspace{66pt}\vdots  \\
      a^{(k)}(n+1) &= \alpha_{k1}a^{(1)}(n) + \hdots + \alpha_{kk}a^{(k)}(n)
    \end{align*} each equation satisfies the recurrence \[
      a^{(i)}(n) = -\beta_{k-1}a^{(i)}(n-1) - \hdots -\beta_{1}a^{(i)}(n-k-1) - \beta_0 a^{(i)}(n-k)
    \] for $n > k$ where $A = \{\alpha_{ij}\}_{i,j=1}^k$ is the coefficient matrix and \[
      m_A(x) = x^k + \beta_{k-1}x^{k-1} + \hdots + \beta_1 x + \beta_0
    \] is the minimal polynomial of $A$.
  \end{theorem}
\end{frame}

\begin{frame}{A single recurrence from a system of recurrences}
  \[
    \underbrace{\begin{bmatrix}
      a_{\indxx 00}(n) \\
      a_{\indxx 01}(n) \\
      a_{\indxx 10}(n) \\
      a_{\indxx 11}(n) \\
      a_{\indxx 12}(n) \\
      a_{\indxx 21}(n) \\
      a_{\indxx 22}(n)
    \end{bmatrix}}_{\vec a(n)}
    =
    \underbrace{\begin{bmatrix}
      1 & 0 & 0 & 0 & 0 & 0 & 1 \\ % 00
      0 & 1 & 0 & 0 & 0 & 1 & 1 \\ % 01
      0 & 0 & 1 & 0 & 1 & 0 & 1 \\ % 10
      1 & 0 & 0 & 1 & 1 & 1 & 2 \\ % 11
      0 & 1 & 0 & 0 & 0 & 1 & 1 \\ % 12
      0 & 0 & 1 & 0 & 1 & 0 & 1 \\ % 21
      0 & 0 & 0 & 1 & 1 & 1 & 1 \\ % 22
    \end{bmatrix}^{n-1}}_{A^{n-1}}
    \underbrace{\begin{bmatrix}
      1 \\ 0 \\ 0 \\ 1 \\ 0 \\ 0 \\ 0
    \end{bmatrix}}_{\vec a(1)}
  \]

  Let $x^k + \beta_{k-1}x^{k-1} + \hdots + \beta_1 x + \beta_0$
  be the minimal polynomial of $A$.
  Then \begin{alignat*}{6}
    &A^k    &          &= -\beta_{k-1}A^{k-1}          &&- \hdots &&- \beta_1 A                &&- \beta_0 \\
    &A^{n-1}&\vec a(1) &= -\beta_{k-1}A^{n-2}\vec a(1) &&- \hdots &&- \beta_1 A^{n-k}\vec a(1) &&- \beta_0 A^{n-k-1}\vec a(1) \\
    &       &\vec a(n) &= -\beta_{k-1}\vec a(n-1)      &&- \hdots && - \beta_1 \vec a(n-k+1)   &&- \beta_0 \vec a(n-k)
  \end{alignat*}
\end{frame}

\begin{frame}{Some conjectural recurrences}
  For $k = 3, 4, 5$, $a_k(n)$ the number of leaf-free subgraphs of the $n \times k$
  grid graph is conjectured to satisfy
  \begin{alignat*}{3}
    % A301976
    % I can prove this satisfies the five term recurrence
    %    a(n) = 13a(n-1) - 18a(n-2) - 14a(n-3) + 15a(n-4) + 5a(n-5)
    % which is divisible by the minimal polynomial of a coefficient matrix.
     a_3(n) &= 12a_3(n-1)  &&-     6a_3(n-2) &&-    20a_3(n-3) \\
           &-  5a_3(n-4)  && &&
    \\~\\
    % A320097
    a_4(n) &= 36a_4(n-1)  &&-     7a_4(n-2) &&-   201a_4(n-3) \\
           &+ 49a_4(n-4)  &&+    20a_4(n-5) &&-     5a_4(n-6) \\
    \\
    % A320099 % If a coefficient looks like it might be prime, it is.
    a_5(n) &=   103a_5(n-1) &&+  1063a_5(n-2) &&-  1873a_5(n-3) \\
           &- 20274a_5(n-4) &&+ 44071a_5(n-5) &&- 10365a_5(n-6) \\
           &- 20208a_5(n-7) &&+ 5959a_5(n-8)  &&+  2300a_5(n-9) \\
           &- 500a_5(n-10)  &&                &&
  \end{alignat*}
  For $k = 6$, this is the conjectured to be an $18$-order recurrence.
  % a(n) = 328       * a(n-1)
  %      + 9352      * a(n-2)
  %      - 73707     * a(n-3)
  %      - 1316926   * a(n-4)
  %      + 17899527  * a(n-5)
  %      - 86159484  * a(n-6)
  %      + 197347344 * a(n-7)
  %      - 189660665 * a(n-8)
  %      - 31064889  * a(n-9)
  %      + 181086417 * a(n-10)
  %      - 67203429  * a(n-11)
  %      - 44867092  * a(n-12)
  %      + 22863191  * a(n-13)
  %      + 3088843   * a(n-14)
  %      - 2085907   * a(n-15)
  %      - 14621     * a(n-16)
  %      + 54420     * a(n-17)
  %      - 3420      * a(n-18)
\end{frame}

\begin{frame}{Graphs which satisfy linear recurrences}
  \input{diagrams/G_square_Pn}
  \begin{theorem}[Faase, 1994] % https://www.researchgate.net/publication/2588839_On_the_number_of_specific_spanning_subgraphs_of_the_graphs_G_P_n
    Let $G$ be an arbitrary finite graph and let $H_n$ denote either the path
    graph $P_n$ or the cycle graph $C_n$ on $n$ vertices, and let $s(n)$
    count the number of subgraphs $S$ of the Cartesian product $G \square H_n$
    subject to any combination of the following properties:
    \begin{enumerate}
      \item Restrictions on degree
      \item Connectivity
      \item Acyclicity
    \end{enumerate}
    Then $s(n)$ satisfies some linear recurrence.
  \end{theorem}
\end{frame}

\begin{frame}{Graphs which satisfy linear recurrences}
  \begin{corollary}
    Let $G$ be an arbitrary finite graph with some notion of horizontal and
    vertical symmetry. Then let $s(n)$ count the number of subsets of
    $G \square P_n$ subject to any combination of the following properties:
    \begin{enumerate}
      \item Exactly $m_1, m_2, \hdots, m_k$ vertices of degree
        $d_1, d_2, \hdots, d_k$ respectively.
      \item Exactly $\ell$ connected components.
      \item Reflection symmetry (horizontal)
      \item Reflection symmetry (vertical)
    \end{enumerate}
    Then $s(n)$ satisfies some linear recurrence.
  \end{corollary}
  % Example?
\end{frame}

\begin{frame}{Linear recurrences for graphs which are symmetric}
  \begin{theorem}
    Let $G$ be an arbitrary finite graph with vertex set
    $V = \{ v_1, v_2, \hdots, v_m \},$
    and let $P_n$ denote the path graph on $n$ vertices.
    Then let $H_n$ be the graph Cartesian product $G \square P_n$ together with
    a choice of adding edges between the first row and the last row.
    (i.e. some $E \in V \times V$ such that
    $\{((1, v_i), (n, v_j)) : (v_i, v_j) \in E\})$ is added to the edge set.)
    Next let $s(n)$ count the number of subgraphs $S \subset H_n$
    subject to any combination of the following properties:
    \begin{enumerate}
      \item Restrictions on degree
      \item Connectivity
      \item Acyclicity
    \end{enumerate}
    Then $s(n)$ satisfies some linear recurrence.
  \end{theorem}
  Note that $E = \{(v_1, v_1), (v_2, v_2), \hdots, (v_m, v_m)\}$ recovers
  $G \square C_n$ and $E = \emptyset$ recovers $G \square C_n$.
\end{frame}

\begin{frame}{Up to horizontal/vertical reflection} % A303930
  The number of no-leaf subgraphs of the $2 \times n$ grid satisfies the two
  term recurrence \[
    a_2(n) = 5a_2(n-1) - 5a_2(n-2).
  \]

  The number of no-leaf subgraphs of the $2 \times n$ grid up to
  horizontal/vertical reflection is conjectured to satisfy the eight term
  recurrence
  \begin{align*}
    s(n) &= 8s(n-1) - 16s(n-2) - 20s(n-3) + 95s(n-4) \\
         &\hspace{1cm}- 60s(n-5) - 80s(n-6) + 100s(n-7) - 25s(n-8)
  \end{align*}
  \input{diagrams/2Xn_up_to_reflection}
  % Eight term linear recurrence.
\end{frame}

\begin{frame}{Mazes and Spanning Trees}
  % Can we count this up to dihedral action?
  % Does there exist such a tree with >k leaves? This is NP-complete.
  %   (Maximum Leaf Spanning Tree Problem for Grid Graphs by Li)
  \input{diagrams/maze_spanning_trees}
\end{frame}

\begin{frame}{Generalizations}
  % \textbf{can do}
  % \begin{enumerate}
  %   % \item Other degree restrictions. We saw $\deg(v) \neq 0$, but we could do, say
  %   % \item $\deg(v) \in \{2,3\}$
  %   % \item Connectivity restrictions, say, exactly $m$ connected components.
  %   % \item Other graphs, e.g. King graph. Arbitrary $G \square P_n$, $K_{m,m,\hdots,m}$, cylinder, torus.
  %   % \item Exactly $m$ vertices of degree $0$.
  %   % \item Avoiding cycles
  % \end{enumerate}

  \textbf{can't do}
  \begin{enumerate}
    \item Can't count $k \times n$ for $k > 7$.
    \item It's faster to do, e.g. Kirchhoff's matrix tree theorem than count spanning trees this way.
    \item (?) Can't count, say, acyclic orientations of G.
    \item (?) Chromatic number exactly $2$ on $G \square P_n$?
    \item Global properties: (e.g. no connected component is a shift of another connected component.)
    \item Figure out how long a particular recurrence is.
  \end{enumerate}

\end{frame}
\end{document}
