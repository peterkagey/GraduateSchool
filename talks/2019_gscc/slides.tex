\documentclass{beamer}%
% Choose how your presentation looks.
%
% For more themes, color themes and font themes, see:
% http://deic.uab.es/~iblanes/beamer_gallery/index_by_theme.html
%
\mode<presentation>
{
  \usetheme{default}      % or try Darmstadt, Madrid, Warsaw, ...
  \usecolortheme{beaver} % or try albatross, beaver, crane, ...
  \usefonttheme{default}  % or try serif, structurebold, ...
  \usefonttheme[onlymath]{serif}
  \setbeamertemplate{navigation symbols}{}
  \setbeamertemplate{caption}[numbered]
}

\setlength{\belowcaptionskip}{-10pt}

\usepackage[english]{babel}
\usepackage[utf8x]{inputenc}
\usepackage{mathtools}
\usepackage{tikz, pgfplots}
\usetikzlibrary{shapes.geometric}

\newcommand\indx[2]{\genfrac{}{}{0pt}{1}{#1}{#2}}
\newcommand\indxx[2]{#1#2}
\newcommand\indxxx[2]{\genfrac{}{}{0pt}{0}{#1}{#2}}

\newcommand\paren[1]{\biggl(#1\biggr)}
\newcommand\set[1]{\left\{#1\right\}}

\title{Counting structures on the $n \times k$ grid graph}
\author{Peter Kagey}
\institute{University of Southern California}
\date[]{
  Graduate Student Combinatorics Conference\\
  Saturday, April 6, 2019
}

\begin{document}
\begin{frame}
  \titlepage
\end{frame}

\begin{frame}{Commodore 64 (1/3)} % https://www.youtube.com/watch?v=m9joBLOZVEo
  % When I was working in software, I became known for my one-off programming
  % projects, and so when my colleague ran across this video, he sent it to me,
  % and it indeed piqued my curiosity.
  \center{\includegraphics[width=300pt]{commodore64_1.png}}
\end{frame}

\begin{frame}{Commodore 64 (2/3)} % https://www.youtube.com/watch?v=m9joBLOZVEo
  \center{\includegraphics[width=300pt]{commodore64_2.png}}
\end{frame}

\begin{frame}{Commodore 64 (3/3)} % https://www.youtube.com/watch?v=m9joBLOZVEo
  \center{\includegraphics[width=300pt]{commodore64_3.png}}
\end{frame}

\begin{frame}{Javascript} % https://www.youtube.com/watch?v=m9joBLOZVEo
  \center{\includegraphics[width=300pt]{website_pre.png}}
\end{frame}

\begin{frame}{Javascript} % https://www.youtube.com/watch?v=m9joBLOZVEo
  \center{\includegraphics[width=300pt]{website_post.png}}
\end{frame}

\begin{frame}{Counting tilings of the grid} % V2 Problem 56.
  \begin{figure}
    \input{diagrams/diagonal-quarter_circle_duality}
    \caption{An illustration of the bijection between tiles with diagonal markings and tiles with quarter circles in opposite corners.}
  \end{figure}
\end{frame}

\begin{frame}{A295229: Number of tilings of the $n \times n$ grid, using diagonal lines to connect the grid points.}
  % A295229
  \input{diagrams/2X2_diagonals_up_to_symmetry}
  \[
    a(n) = \begin{cases}
      \frac 18 (2^{n^2} + 2\cdot2^{n(n+1)/2} + 3\cdot2^{n^2/2} + 2\cdot2^{n^2/4}) & n \text{ even} \\
      \frac 18 (2^{n^2} + 2\cdot2^{n(n+1)/2} + 2^{(n^2+1)/2}) & n \text{ odd}
    \end{cases}
  \]
  % $1, 6, 84, 8548, 4203520, 8590557312, 70368815480832, \hdots$
\end{frame}

\begin{frame}{Grids with other tiles} % https://www.youtube.com/watch?v=m9joBLOZVEo
    \begin{figure}
      \input{diagrams/box_drawing_characters}
      \includegraphics[width=230pt]{pseudomaze2.png}
      \caption{Eleven box-drawing characters placed on an $15 \times 8$ grid}
    \end{figure}
\end{frame}

\begin{frame}{Baby's first corollary}
  \begin{corollary}[of Burnside's Lemma]
    Let \begin{itemize}
      \item $t$ be the number of tiles,
      \item $q$ be the number of tiles symmetric under a $90^\circ$ rotation,
      \item $h$ be the number of tiles symmetric under a $180^\circ$ rotation,
      \item $d$ be the number of tiles symmetric under a diagonal reflection, and
      \item $v$ be the number of tiles symmetric under a vertical reflection.
    \end{itemize}
    Then the number of tilings up to symmetries of the square is
  \[
    a(n) = \begin{cases}
      \frac 18 \paren{
        t^{n^2} + 2qt^{\frac{n^2-1}{4}} + ht^{\frac{n^2-1}{2}} + (v^n + d^n)t^{\frac{n^2-n}{2}}
      } & n \text{ odd} \\
      \\
      \frac 18 \paren{
        t^{n^2} + 3t^{\frac{n^2}{2}} + 2t^{\frac{n^2}{4}} + 2d^n t^{\frac{n^2-n}{2}}
      } & n \text{ even}
    \end{cases}
  \]
  \end{corollary}
\end{frame}

\begin{frame}{Pipe Mania}
  \center{\includegraphics[width=300pt]{pipe_mania.png}}
\end{frame}

\begin{frame}{Leaf-free subgraphs of the grid graph} % V2 Problem 56.
  % Can also use this to count multipartite graphs and planar multipartite graphs.
  \begin{figure}[!h]
    \input{diagrams/leaf_free_4X12}
    \caption {
      One of the $a_4(12) = 42 650 154 782 713 601$ ($42$ quadrillion) subgraphs on the $12 \times 4$ grid graph $G_{12,4} = P_{12} \square P_{4}$.
    }
  \end{figure}
  The number of leaf-free subgraphs of $G_{n,2}$ grid, obeys the recurrence
  \begin{align*}
    a_2(1) &= 1,\ a_2(2) = 2 \\
    a_2(n) &= 5a(n-1) - 5a(n-2).
    % \\
    % \\
    % a_3(1) &= 1, a_3(2) = 5, a_3(3) = 43, a_3(4) = 463 \\
    % a_3(n) &= 12a(n-1) - 6a(n-2) - 20a(n-3) - 5a(n-4)
    % \\
    % \\
    % a_4(1) &= 1, a_4(2) = 15, a_4(3) = 463, a_4(4) = 16372, \\
    % a_4(5) &= 583199, a_4(6) = 20788249  \\
    % a_4(n) &= 36a_4(n-1) - 7a_4(n-2) - 201a_4(n-3) + 49a_4(n-4) \\
    % &+ 20a_4(n-5) - 5a_4(n-6)
  \end{align*}
\end{frame}

\begin{frame}{Leaf-free subgraphs: intermediate states}
  \begin{figure}[ht!]
    \input{diagrams/state_2X13}
    \caption{An example of a leaf-free subgraph with its states labeled}
  \end{figure}
  \begin{figure}[ht!]
    \input{diagrams/next_generation_2Xn}
    \caption{Two examples of transitions from states to their children}
  \end{figure}
\end{frame}
%
\begin{frame}{Example: a system of linear difference equations}
  The states of leaf-free subgraphs on the $1 \times 2$ grid satisfy the initial
  conditions
  \begin{align*}
    a_{\indxx 00}(1) &= a_{\indxx 11}(1) = 1 \\
    a_{\indxx 10}(1) &= a_{\indxx 01}(1) = a_{\indxx 12}(1) = a_{\indxx 21}(1) = a_{\indxx 22}(1) = 0,
  \end{align*}
  and satisfy the system of first order homogeneous linear difference equations
  \begin{align*}
    a_{\indxx 00}(n + 1) &= a_{\indxx 00}(n) + a_{\indxx 22}(n) \\
    a_{\indxx 01}(n + 1) &= a_{\indxx 01}(n) + a_{\indxx 21}(n) + a_{\indxx 22}(n) \\
    a_{\indxx 10}(n + 1) &= a_{\indxx 10}(n) + a_{\indxx 12}(n) + a_{\indxx 22}(n) \\
    a_{\indxx 11}(n + 1) &= a_{\indxx 00}(n) + a_{\indxx 11}(n) + a_{\indxx 12}(n)
                      + a_{\indxx 21}(n) + 2a_{\indxx 22}(n) \\
    a_{\indxx 12}(n + 1) &= a_{\indxx 01}(n) + a_{\indxx 21}(n) + a_{\indxx 22}(n) \\
    a_{\indxx 21}(n + 1) &= a_{\indxx 10}(n) + a_{\indxx 12}(n) + a_{\indxx 22}(n) \\
    a_{\indxx 22}(n + 1) &= a_{\indxx 11}(n) + a_{\indxx 12}(n) + a_{\indxx 21}(n) + a_{\indxx 22}(n).
  \end{align*}
\end{frame}

\begin{frame}{A single recurrence from a system of recurrences}
  \begin{corollary}[of Cayleyâ€“Hamilton theorem]
    In a system of first order homogeneous linear difference equations, \begin{align*}
      a^{(1)}(n+1) &= \alpha_{11}a^{(1)}(n) + \hdots + \alpha_{1k}a^{(k)}(n) \\
      \vdots\hspace{25pt} &= \hspace{66pt}\vdots  \\
      a^{(k)}(n+1) &= \alpha_{k1}a^{(1)}(n) + \hdots + \alpha_{kk}a^{(k)}(n)
    \end{align*} each equation satisfies the recurrence \[
      a^{(i)}(n) = -\beta_{k-1}a^{(i)}(n-1) - \hdots -\beta_{1}a^{(i)}(n-k-1) - \beta_0 a^{(i)}(n-k)
    \] for $n > k$ where $A = \{\alpha_{ij}\}_{i,j=1}^k$ is the coefficient matrix and \[
      m_A(x) = x^k + \beta_{k-1}x^{k-1} + \hdots + \beta_1 x + \beta_0
    \] is the minimal polynomial of $A$.
  \end{corollary}
\end{frame}

\begin{frame}{A single recurrence from a system of recurrences}
  \[
    \underbrace{\begin{bmatrix}
      a_{\indxx 00}(n) \\
      a_{\indxx 01}(n) \\
      a_{\indxx 10}(n) \\
      a_{\indxx 11}(n) \\
      a_{\indxx 12}(n) \\
      a_{\indxx 21}(n) \\
      a_{\indxx 22}(n)
    \end{bmatrix}}_{\vec a(n)}
    =
    \underbrace{\begin{bmatrix}
      1 & 0 & 0 & 0 & 0 & 0 & 1 \\ % 00
      0 & 1 & 0 & 0 & 0 & 1 & 1 \\ % 01
      0 & 0 & 1 & 0 & 1 & 0 & 1 \\ % 10
      1 & 0 & 0 & 1 & 1 & 1 & 2 \\ % 11
      0 & 1 & 0 & 0 & 0 & 1 & 1 \\ % 12
      0 & 0 & 1 & 0 & 1 & 0 & 1 \\ % 21
      0 & 0 & 0 & 1 & 1 & 1 & 1 \\ % 22
    \end{bmatrix}^{n-1}}_{A^{n-1}}
    \underbrace{\begin{bmatrix}
      1 \\ 0 \\ 0 \\ 1 \\ 0 \\ 0 \\ 0
    \end{bmatrix}}_{\vec a(1)}
  \]

  Let $x^k + \beta_{k-1}x^{k-1} + \hdots + \beta_1 x + \beta_0$
  be the minimal polynomial of $A$.
  Then \begin{alignat*}{6}
    &A^k    &          &= -\beta_{k-1}A^{k-1}          &&- \hdots &&- \beta_1 A                &&- \beta_0 \\
    &A^{n-1}&\vec a(1) &= -\beta_{k-1}A^{n-2}\vec a(1) &&- \hdots &&- \beta_1 A^{n-k}\vec a(1) &&- \beta_0 A^{n-k-1}\vec a(1) \\
    &       &\vec a(n) &= -\beta_{k-1}\vec a(n-1)      &&- \hdots && - \beta_1 \vec a(n-k+1)   &&- \beta_0 \vec a(n-k)
  \end{alignat*}
\end{frame}

\begin{frame}{Some conjectural recurrences}
  For $k = 3, 4, 5$, $a_k(n)$ the number of leaf-free subgraphs of the $n \times k$
  grid graph is conjectured to satisfy
  \begin{alignat*}{3}
    % A301976
    % I can prove this satisfies the five term recurrence
    %    a(n) = 13a(n-1) - 18a(n-2) - 14a(n-3) + 15a(n-4) + 5a(n-5)
    % which is divisible by the minimal polynomial of a coefficient matrix.
     a_3(n) &= 12a_3(n-1)  &&-     6a_3(n-2) &&-    20a_3(n-3) \\
           &-  5a_3(n-4)  && &&
    \\~\\
    % A320097
    a_4(n) &= 36a_4(n-1)  &&-     7a_4(n-2) &&-   201a_4(n-3) \\
           &+ 49a_4(n-4)  &&+    20a_4(n-5) &&-     5a_4(n-6) \\
    \\
    % A320099 % If a coefficient looks like it might be prime, it is.
    a_5(n) &=   103a_5(n-1) &&+  1063a_5(n-2) &&-  1873a_5(n-3) \\
           &- 20274a_5(n-4) &&+ 44071a_5(n-5) &&- 10365a_5(n-6) \\
           &- 20208a_5(n-7) &&+ 5959a_5(n-8)  &&+  2300a_5(n-9) \\
           &- 500a_5(n-10)  &&                &&
  \end{alignat*}
  For $k = 6$, this is the conjectured to be an $18$-order recurrence.
  % a(n) = 328       * a(n-1)
  %      + 9352      * a(n-2)
  %      - 73707     * a(n-3)
  %      - 1316926   * a(n-4)
  %      + 17899527  * a(n-5)
  %      - 86159484  * a(n-6)
  %      + 197347344 * a(n-7)
  %      - 189660665 * a(n-8)
  %      - 31064889  * a(n-9)
  %      + 181086417 * a(n-10)
  %      - 67203429  * a(n-11)
  %      - 44867092  * a(n-12)
  %      + 22863191  * a(n-13)
  %      + 3088843   * a(n-14)
  %      - 2085907   * a(n-15)
  %      - 14621     * a(n-16)
  %      + 54420     * a(n-17)
  %      - 3420      * a(n-18)
\end{frame}

\begin{frame}{Subgraphs which satisfy linear recurrences}
  \input{diagrams/G_square_Pn}
  \begin{theorem}[Faase, 1994] % https://www.researchgate.net/publication/2588839_On_the_number_of_specific_spanning_subgraphs_of_the_graphs_G_P_n
    Let $G$ be an arbitrary finite graph and let $H_n$ denote either the path
    graph $P_n$ or the cycle graph $C_n$ on $n$ vertices, and let $s(n)$
    count the number of subgraphs $S$ of the Cartesian product $G \square H_n$
    subject to any combination of the following properties:
    \begin{enumerate}
      \item Restrictions on degree
      \item Connectivity
      \item Acyclicity
    \end{enumerate}
    Then $s(n)$ satisfies a linear recurrence.
  \end{theorem}
\end{frame}

\begin{frame}{Examples: subgraphs which satisfy linear recurrences}
  Let $G_{n,k}$ be a grid graph, then the following classes of
  subgraphs satisfy linear recurrences:
  \begin{columns}
    \begin{column}{0.55\textwidth}
      \begin{itemize}
        \item Leaf-free subgraphs \begin{itemize}
          \item Degree set $D = \{0, 2, 3, 4\}$
        \end{itemize}
        \item Spanning tree (mazes) \begin{itemize}
          \item Degree set $D = \{1,2,3,4\}$
          \item Connected
          \item Acyclic
        \end{itemize}
      \end{itemize}
    \end{column}
    \begin{column}{0.45\textwidth}
      \begin{itemize}
        \item Hamiltonian paths \begin{itemize}
          \item Degree set $D = \{1, 2\}$
          \item Connected
          \item Acyclic
        \end{itemize}
        \item Perfect matchings (domino tilings) \begin{itemize}
          \item Degree set $D = \{1\}$
        \end{itemize}
      \end{itemize}
    \end{column}
  \end{columns}
  \begin{figure}[ht!]
    % Can we count this up to dihedral action?
    % Does there exist such a tree with >k leaves? This is NP-complete.
    %   (Maximum Leaf Spanning Tree Problem for Grid Graphs by Li)
    \input{diagrams/maze_spanning_trees}
    \caption{A correspondence between mazes and spanning trees}
  \end{figure}
\end{frame}

\begin{frame}{Tiling with $3$-ominoes}
  Recall domino tilings were counted by subgraphs of the grid with degree set $D = \set{1}$.
  \\
  Similarly, $3$-omino tilings are counted by subgraphs of the grid where each
  component has exactly three vertices.
  \begin{figure}
    \input{diagrams/triomino_tiling}
    \caption{Correspondence between subgraphs and triomino tilings}
  \end{figure}

\end{frame}

\begin{frame}{More subgraphs which satisfy linear recurrences}
  \begin{theorem}
    Let $G$ be an arbitrary finite graph, and let $s(n)$ count the number of
    subgraphs of $G \square P_n$ subject to any combination of the following
    properties:
    \begin{enumerate}
      \item Exactly/fewer than/more than $m$ vertices of degree $d$
      \item Exactly/fewer than/more than $m$ connected components on
        exactly/fewer than/more than $d$ vertices.
      \item Has $k \pmod m$ vertices of degree $d$
      \item Exactly/fewer than/more than $\ell$ connected components containing
        exactly/fewer than/more than $v$ vertices.
    \end{enumerate}
    Then $s(n)$ satisfies a linear recurrence.
  \end{theorem}
\end{frame}

\begin{frame}{Counting up to symmetry} % A303930
  The number of no-leaf subgraphs of the $2 \times n$ grid satisfies the two
  term recurrence \[
    a_2(n) = 5a_2(n-1) - 5a_2(n-2).
  \]

  The number of no-leaf subgraphs of the $2 \times n$ grid up to
  horizontal/vertical reflection is conjectured to satisfy the eight term
  recurrence
  \begin{align*}
    s(n) &= 8s(n-1) - 16s(n-2) - 20s(n-3) + 95s(n-4) \\
         &\hspace{1cm}- 60s(n-5) - 80s(n-6) + 100s(n-7) - 25s(n-8)
  \end{align*}
  \input{diagrams/2Xn_up_to_reflection}
  % Eight term linear recurrence.
\end{frame}

\begin{frame}{Subgraphs up to group action}
  \begin{theorem}
    Suppose $H$ is a group and the finite graph $X$ is an $H$-set which is
    fixed under the action of $H$, and consider $P_n$ under the action of
    $\mathbb Z_2$ which is either the identity on $P_n$ or reverses $P_n$.
    Next let $s(n)$ count the number of subgraphs $S \subset X \square P_n$
    such that $S$ is fixed under the action of $(h, d)$ for
    $(h, d) \in H \times \mathbb Z_2$
    Then $s(n)$ is defined by a linear recurrence.
  \end{theorem}
  \begin{corollary}
    The number of subgraphs of $X \square P_n$ (with appropriate vertex degree,
    connectivity, or acyclicity restrictions) counted up to the group action of
    $H \times \mathbb Z_2$ satisfies a linear recurrence.
  \end{corollary}
\end{frame}

\begin{frame}{Example: M\"obius ladder (Guy, 1967)}
  \begin{figure}
    \includegraphics[width=240pt]{diagrams/Moebius-ladder-16.png}
    \caption{From Wikipedia: the M\"obius ladder $M_{16}$ on $16$ vertices.}
  \end{figure}
  \begin{fact}
    The number of leaf-free subgraphs on the M\"obius ladder on $2n$ vertices is
    equal to the number of leaf-free subgraphs on the $(n + 2) \times 2$ grid
    graph.
  \end{fact}
\end{frame}

\begin{frame}{Cycling around (a generalization of the M\"obius ladder)}
  \begin{theorem}
    Let $G$ be an arbitrary finite graph with vertex set
    $V = \{ v_1, v_2, \hdots, v_m \},$
    and let $E \subseteq V \times V$.
    Then let $H_n$ be the graph Cartesian product $G \square P_n$ together with
    the edges $\{((1, v_i), (n, v_j)) : (v_i, v_j) \in E\})$
    \\
    Next let $s(n)$ count the number of subgraphs of $H_n$
    subject to any combination of the following properties:
    \begin{enumerate}
      \item Restrictions on degree
      \item Connectivity
      \item Acyclicity
    \end{enumerate}
    Then $s(n)$ satisfies a linear recurrence.
  \end{theorem}
  Note that $E = \{(v_1, v_1), (v_2, v_2), \hdots, (v_m, v_m)\}$ recovers
  $G \square C_n$ and $E = \emptyset$ recovers $G \square P_n$.
\end{frame}

\begin{frame}{Example: king graph}
  Let $P_5$ be the path labeled $v_1, v_2, \hdots, v_5$ in the obvious way, and let
  $E = \set{(v_i, v_{i+i}) : i < 5} \cup \set{(v_i, v_{i}) : i \in [5]} \cup \set{(v_i, v_{i-i}) : i > 1}$.
  \begin{figure}
    \input{diagrams/king_walk}
    \caption{
      The number of ways a king can tour every square of the
      $5 \times 15$ chessboard is given by the number of Hamiltonian
      subgraphs in the $5 \times 15$ king graph
    }
  \end{figure}
  The number of kings tours on a $k \times n$ chessboard is a linear
  recurrence in $n$.
\end{frame}

\begin{frame}{More exotic connections}
  \begin{theorem}
    Let $G$ be an arbitrary finite graph with vertex set
    $V = \{ v_1, v_2, \hdots, v_m \}$, and let $E \subseteq V \times V$.
    Then let $H_n$ be the disjoint union
    $\underbrace{G \sqcup G \sqcup \hdots \sqcup G}_{n \text{ times}}$ together with the edges \[
      \{((k, v_i), (k + 1, v_j)) : (v_i, v_j) \in E, k \in [n-1]\}.
    \]
    Next let $s(n)$ count the number of subgraphs of $H_n$
    subject to any combination of the properties mentioned in the previous theorems.
    Then $s(n)$ satisfies a linear recurrence.
  \end{theorem}
  Note that $E = \{(v_1, v_1), (v_2, v_2), \hdots, (v_m, v_m)\}$ recovers
  $G \square C_n$.
\end{frame}

\begin{frame}{Open questions}
  \begin{itemize}
    \item Do there exist general nice algorithms for counting subgraphs of the
      $n \times n$ grid graph satisfying particular properties?
    % \item Is there a general algorithm which given some list of properties can
    % produce a linear recurrence on the number of graphs satisfying that property?
      % \begin{itemize}
      %   \item There are fast ways of counting domino tilings and spanning trees.
      % \end{itemize}
    % \item It's sometimes faster to do, e.g. Kirchhoff's matrix tree theorem than count spanning trees this way.
    % \item (?) Can't count, say, acyclic orientations of G.
    % \item (?) Chromatic number exactly $2$ on $G \square P_n$?
    % \item Global properties: (e.g. no connected component is a shift of another connected component.)
    \item Given some graph and some properties on subgraphs, how do you find
      the order of the smallest recurrence that counts the number of such
      subgraphs?
    \item What is the expected value of a randomly selected component in the
    diagonal ``maze'' construction shown in the Commodore 64 program?
    What's the expected number of connected components?
    \item What if we want to count structures on other tiles, e.g.:
      \input{diagrams/other_tiles}
  \end{itemize}
\end{frame}
\end{document}
